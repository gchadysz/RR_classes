---
title: "Yahoo Finance stock price analysis"
author: "Grzegorz Chadysz, Konrad Archici≈Ñski"
date: "`r format(Sys.time(), '%d.%m.%Y')`"
output:
  prettydoc::html_pretty:
    theme: architect
    highlight: github
    toc: yes
  html_document:
    toc: yes
params:
  Company:
    value: "MSFT"
    input: select
    choices: ["INTC", "MSFT", "NVDA", "AMD", "GM", "F", "TM"]
  From: 
    value: !r lubridate::today() - 1000
    input: date
    max: !r lubridate::today()
  To:
    value: !r lubridate::today()
    input: date
    max: !r lubridate::today()
  Columns: 
    value: "None"
    label: "Quotes"
    choices: ["Open", "High", "Low", "Close", "Volume", "Adjusted"]
    input: select
    multiple: yes
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r, echo=F, message=F, warning=F}
library(lubridate)
library(quantmod)
library(tidyverse)
```

## Intro

Checking parameters:

```{r}
print(params$Company)
print(params$From)
print(params$To)
print(params$Columns)
print(class(params$Columns))
```

## Data

Getting the quotes:

```{r, echo=F, message=F, warning=F}
quotes <- getSymbols(
  params$Company,
  auto.assign = F,
  from = params$From,
  to = params$To
)
```

Adjusting according to ticked checkboxes:

```{r}
head(quotes)
columns_all <- c("Open", "High", "Low", "Close", "Volume", "Adjusted")
columns_to_keep <- paste0(params$Company, ".", params$Columns)
quotes <- subset(quotes, select = columns_to_keep)
head(quotes)
```

## Plot

```{r}
#ggplot(quotes, aes(x = index(quotes))) +
#  geom_line(aes(y = ))
```



